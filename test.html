<!DOCTYPE html>
<html lang="si">
<head>
    <style id="security-curtain">
        html { display: none !important; }
    </style>

    <script>
    (function(){
        // CONFIGURATION
        // 1. The specific Web App URL you want to allow
        var allowedWebApp = "myappmaker.io/Suba_Namak";
        // 2. The Dashboard URL (for your preview)
        var allowedDashboard = "dashboard.appmaker.lk";
        
        var _0xRef = document.referrer;
        var _0xInFrame = (window.self !== window.top);
        var _0xSafe = false;

        // --- CHECK 1: IS IT THE MOBILE APP? (The "Secret Handshake") ---
        // We check if the URL contains "?mode=app"
        if (window.location.search.indexOf("mode=app") > -1) {
            _0xSafe = true;
        }

        // --- CHECK 2: IS IT A DIRECT VIEW (NOT IFRAME)? ---
        else if (!_0xInFrame) {
            _0xSafe = true; 
        }

        // --- CHECK 3: IS IT THE WEB APP (REFERRER)? ---
        else {
            if (!_0xRef || _0xRef === "") {
                // Block empty referrers (Thieves & W3Schools)
                _0xSafe = false;
            } else {
                // Check if referrer contains the EXACT Web App URL
                if (_0xRef.indexOf(allowedWebApp) > -1) {
                    _0xSafe = true;
                }
                // Check if referrer is the Appmaker Dashboard (So you can build the app)
                else if (_0xRef.indexOf(allowedDashboard) > -1) {
                    _0xSafe = true;
                }
            }
        }

        // EXECUTION (Wait & Wipe Logic)
        if (_0xSafe) {
            // SAFE: Lift Curtain
            var _0xCss = document.getElementById('security-curtain');
            if (_0xCss) _0xCss.parentNode.removeChild(_0xCss);
        } else {
            // UNSAFE: Wait for load, then Nuke
            window.onload = function() {
                document.body.innerHTML = "<div style='text-align:center;margin-top:20%;font-family:sans-serif;color:red'><h1>ACCESS DENIED</h1><p>Unauthorized Source.</p></div>";
                var _0xCss = document.getElementById('security-curtain');
                if (_0xCss) _0xCss.parentNode.removeChild(_0xCss);
            };
            try { window.top.location = window.self.location; } catch(e){}
        }
    })();
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>නාම යෝනිය සෙවීම</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Gemunu+Libre:wght@700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+Sinhala:wght@400;700&display=swap');

        :root {
            --primary-color: #7F0000;
            --secondary-color: #FDF5E6;
            --highlight-color: #FFA500;
            --text-dark: #333333;
            --border-color: #d4a373;
            --font-gemunu: 'Gemunu Libre', sans-serif;
            --font-noto: 'Noto Serif Sinhala', serif;
            --success-color: #4CAF50;
            --warning-color: #FFC107;
            --danger-color: #F44336;
            --success-bg: #e8f5e9;
            --warning-bg: #fffde7;
            --danger-bg: #ffebee;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-noto);
            background-color: var(--secondary-color);
            color: var(--text-dark);
            line-height: 1.6;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            text-align: center;
            border: 1px solid var(--border-color);
            margin-bottom: 3rem;
        }

        h1 {
            font-family: var(--font-gemunu);
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background-color: var(--highlight-color);
            border-radius: 3px;
        }

        h2 {
            font-family: var(--font-noto);
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin: 30px 0 15px;
            position: relative;
            padding-bottom: 8px;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 2px;
            background-color: var(--highlight-color);
        }

        .input-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .label-with-icon {
            display: flex;
            align-items: center;
        }
        
        .info-icon {
            margin-left: 8px;
            cursor: pointer;
            color: var(--highlight-color);
            transition: transform 0.2s;
            position: relative;
        }

        .info-icon:hover {
            transform: scale(1.1);
        }
        
        .info-text {
            visibility: hidden;
            width: 250px;
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            top: 25px;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
            box-shadow: var(--shadow);
        }

        .info-icon:hover .info-text {
            visibility: visible;
            opacity: 1;
        }

        .input-group input, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-noto);
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        textarea {
            resize: vertical;
            min-height: 120px;
        }

        .input-group input:focus, textarea:focus {
            outline: none;
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 3px rgba(255, 165, 0, 0.2);
        }

        .cta-btn {
            width: 100%;
            padding: 14px;
            background-color: var(--highlight-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: var(--font-noto);
            margin-top: 10px;
            box-shadow: 0 4px 0 rgba(127, 0, 0, 0.2);
        }

        .cta-btn:hover {
            background-color: #e69500;
            transform: translateY(-2px);
            box-shadow: 0 6px 0 rgba(127, 0, 0, 0.2);
        }

        .cta-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 0 rgba(127, 0, 0, 0.2);
        }

        #result {
            margin-top: 30px;
            font-size: 1.1rem;
            min-height: 50px;
            text-align: left;
            border: 2px dashed var(--border-color);
            padding: 20px;
            border-radius: 10px;
            transition: all 0.3s;
            display: none;
        }
        
        .result-header {
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .result-section {
            margin-bottom: 20px;
        }

        .result-title {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 1.2rem;
        }

        .calc-breakdown {
            font-family: monospace;
            font-size: 1rem;
            color: #555;
            margin-bottom: 5px;
            word-break: break-all;
        }

        .total-value {
            font-weight: 700;
            font-size: 1.3rem;
            color: var(--text-dark);
        }

        .error-message {
            color: var(--danger-color);
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }

        #guide-text, #converter-guide-text {
            color: var(--danger-color);
            font-size: 0.9rem;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            background-color: rgba(244, 67, 54, 0.1);
            display: none;
        }

        #guide-text {
            margin-top: 20px;
        }
        #converter-guide-text {
            margin-bottom: 15px;
        }

        /* Prevent text selection across the entire site */
body {
    -webkit-user-select: none; /* Safari */
    -moz-user-select: none;    /* Firefox */
    -ms-user-select: none;     /* IE10+/Edge */
    user-select: none;         /* Standard */
}

/* Allow selection on input fields so users can still type */
input, textarea {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
}

        .note {
            margin-top: 30px;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background-color: rgba(253, 245, 230, 0.5);
            text-align: left;
            font-size: 0.9rem;
            line-height: 1.7;
            color: var(--text-dark);
        }

        .copyright {
            margin-top: 40px;
            font-size: 0.8rem;
            color: #777;
        }

        .unicode-converter {
            margin-top: 40px;
            border-top: 2px solid var(--border-color);
            padding-top: 20px;
        }
        
        #sinhala-output {
            background-color: rgba(253, 245, 230, 0.5);
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            min-height: 120px;
            text-align: left;
            font-size: 1.1rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .converter-btn {
            background-color: var(--highlight-color);
            color: white;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-family: var(--font-noto);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            font-weight: 600;
            box-shadow: 0 4px 0 rgba(127, 0, 0, 0.2);
        }

        .converter-btn:hover {
            background-color: #e69500;
            transform: translateY(-2px);
            box-shadow: 0 6px 0 rgba(127, 0, 0, 0.2);
        }

        .converter-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 0 rgba(127, 0, 0, 0.2);
        }
        
        #clear-btn { 
            background-color: var(--danger-color); 
        }
        #clear-btn:hover { 
            background-color: #d32f2f; 
        }
        
        #copy-btn { 
            background-color: var(--success-color); 
        }
        #copy-btn:hover { 
            background-color: #388e3c; 
        }
        
        .converter-btn:disabled {
            background-color: #a5d6a7;
            cursor: not-allowed;
            transform: translateY(0);
            box-shadow: 0 4px 0 rgba(127, 0, 0, 0.2);
        }

        @media (max-width: 480px) {
            h1 { font-size: 2rem; }
            .container { padding: 20px; }
            .cta-btn { font-size: 1rem; padding: 12px; }
            .info-text { width: 200px; left: 0; margin-left: 0; }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>නාම යෝනිය සෙවීම</h1>

        <div class="input-group">
            <label for="name1" class="label-with-icon">
                මව්පිය/ සහෝදරයන්ගේ නම්
                <span class="info-icon">
                    <i class="fas fa-info-circle"></i>
                    <span class="info-text">එක් වරකට එක් අයෙකුගේ නම පමණක් ඇතුළත් කරන්න. (උපරිම වචන 3)</span>
                </span>
            </label>
            <input type="text" id="name1" placeholder="නම ඇතුළත් කරන්න">
            <div id="error-name1" class="error-message"></div>
        </div>

        <div class="input-group">
            <label for="name2">ජන්මයාගේ නම</label>
            <input type="text" id="name2" placeholder="නම ඇතුළත් කරන්න (උපරිම වචන 3)">
            <div id="error-name2" class="error-message"></div>
        </div>

        <button class="cta-btn" onclick="calculateNamaYoni()">
            <i class="fas fa-calculator" style="margin-right: 8px;"></i>ප්‍රතිඵලය බලන්න
        </button>

        <div id="guide-text"></div>
        <div id="result"></div>

        <div class="note">
            <p>මෙහිදී ජන්මයාගේ නම සමඟ දෙමාපියන්ගේ නම් හෝ සහෝදර සහෝදරියන්ගේ නම් වෙන වෙනම පරීක්ෂා කොට නාම යෝනි ගැළපීම බලාගත හැක.</p>
        </div>

        <div class="unicode-converter">
            <h2>යුනිකෝඩ් පරිවර්තකය</h2>
            <p>සිංහල නාමය ඉංග්‍රීසි අකුරු (Singlish) යොදා ටයිප් කරන්න.</p>
            
            <div class="input-group">
                <textarea id="singlish-input" placeholder="Type in Singlish here..."
                autocapitalize="none" autocorrect="off" spellcheck="false"></textarea>
            </div>
            
            <div class="input-group">
                <label for="sinhala-output">සිංහල ප්‍රතිඵලය</label>
                <div id="sinhala-output">සිංහල අකුරෙන් මෙතැන පෙන්වනු ලැබේ</div>
            </div>
            
            <div id="converter-guide-text"></div>
            <div>
                <button id="copy-btn" class="converter-btn">
                    <i class="far fa-copy" style="margin-right: 5px;"></i>Copy
                </button>
                <button id="clear-btn" class="converter-btn">
                    <i class="fas fa-eraser" style="margin-right: 5px;"></i>Clear
                </button>
            </div>
        </div>

        <div class="copyright">
            &copy; <span id="current-year"></span> Suba Namak | Astro Jayamaga. All Rights Reserved.
        </div>
    </div>

    
<script>
    /* Security Check - Astro Jayamaga */
(function(){
    var _0x1a2b = ["\x61\x73\x74\x72\x6f\x2d\x6a\x61\x79\x61\x6d\x61\x67\x61\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f", "\x6c\x6f\x63\x61\x6c\x68\x6f\x73\x74", "\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31", "\x68\x6f\x73\x74\x6e\x61\x6d\x65", "\x69\x6e\x64\x65\x78\x4f\x66", "\x62\x6f\x64\x79", "\x69\x6e\x6e\x65\x72\x48\x54\x4d\x4c", "\x3c\x68\x31\x3e\x55\x6e\x61\x75\x74\x68\x6f\x72\x69\x7a\x65\x64\x3c\x2f\x68\x31\x3e\x3c\x70\x3e\x50\x6c\x65\x61\x73\x65\x20\x76\x69\x73\x69\x74\x20\x61\x73\x74\x72\x6f\x2d\x6a\x61\x79\x61\x6d\x61\x67\x61\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x3c\x2f\x70\x3e"];
    var _0x9c4d = window['\x6c\x6f\x63\x61\x74\x69\x6f\x6e'][_0x1a2b[3]];
    
    // Check Domain
    if (_0x9c4d[_0x1a2b[4]](_0x1a2b[0]) === -1 && _0x9c4d !== _0x1a2b[1] && _0x9c4d !== _0x1a2b[2]) {
        // Nuke Body
        document[_0x1a2b[5]][_0x1a2b[6]] = _0x1a2b[7]; 
        // Crash Script
        throw new Error("\x41\x63\x63\x65\x73\x73\x20\x44\x65\x6e\x69\x65\x64");
    }
})();
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // --- CONFIGURATION ---
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwBHhL_H4gwMqfk5Lx_3dZE2HOxlBArsFax9-vVkvzt7ZnRgFDqLlwQ_K-cDAcsxEBt/exec'; 

        // --- Custom Alert/Guide Message Functions ---
        const guideDiv = document.getElementById('guide-text');
        const converterGuideDiv = document.getElementById('converter-guide-text');
        let guideTimeout, converterGuideTimeout;

        function showGuide(message, duration = 4000) {
            clearTimeout(guideTimeout); 
            guideDiv.textContent = message;
            guideDiv.style.display = 'block';
            guideTimeout = setTimeout(() => { guideDiv.style.display = 'none'; }, duration);
        }

        function showConverterGuide(message, duration = 4000) {
            clearTimeout(converterGuideTimeout);
            converterGuideDiv.innerHTML = message;
            converterGuideDiv.style.display = 'block';
            converterGuideTimeout = setTimeout(() => { converterGuideDiv.style.display = 'none'; }, duration);
        }

        // --- Nama Yoni Client Logic (Validation & UI Only) ---

        function validateInput(name, errorId) {
            const errorDiv = document.getElementById(errorId);
            errorDiv.style.display = 'none';
            
            if (!name.trim()) {
                errorDiv.textContent = "කරුණාකර නමක් ඇතුළත් කරන්න.";
                errorDiv.style.display = 'block';
                return false;
            }
            const words = name.trim().split(/\s+/);
            if (words.length > 3) {
                errorDiv.textContent = "වචන 3කට වඩා ඇතුළත් කළ නොහැක.";
                errorDiv.style.display = 'block';
                return false;
            }
            let totalLetters = 0;
            for(let word of words) {
                if (word.length > 10) {
                    errorDiv.textContent = `"${word}" වචනයේ අකුරු ගණන වැඩිය (උපරිම 10).`;
                    errorDiv.style.display = 'block';
                    return false;
                }
                totalLetters += word.length;
            }
            if(totalLetters < 2) {
                errorDiv.textContent = "නම සඳහා අවම වශයෙන් අකුරු 2ක් වත් තිබිය යුතුය.";
                errorDiv.style.display = 'block';
                return false;
            }
            return true;
        }

        // Expose this function to the global scope (window) so HTML buttons can call it
        window.calculateNamaYoni = function() {
            const name1 = document.getElementById('name1').value;
            const name2 = document.getElementById('name2').value;
            const resultElement = document.getElementById('result');
            const btn = document.querySelector('button[onclick="calculateNamaYoni()"]'); // Assuming you have a button

            resultElement.style.display = 'none';
            
            const v1 = validateInput(name1, 'error-name1');
            const v2 = validateInput(name2, 'error-name2');

            if (!v1 || !v2) return;

            // Show Loading State
            if(btn) {
                const originalText = btn.textContent;
                btn.textContent = "ගණනය කරමින්...";
                btn.disabled = true;
            }

            // Call Server
            fetch(`${SCRIPT_URL}?name1=${encodeURIComponent(name1)}&name2=${encodeURIComponent(name2)}`)
                .then(response => response.json())
                .then(data => {
                    if(data.error) {
                        alert(data.error);
                        return;
                    }
                    renderResult(data, resultElement);
                })
                .catch(err => {
                    console.error(err);
                    alert("දත්ත ලබා ගැනීමේ දෝෂයක්. කරුණාකර නැවත උත්සාහ කරන්න.");
                })
                .finally(() => {
                    if(btn) {
                        btn.textContent = "ගණනය කරන්න"; // Reset button text
                        btn.disabled = false;
                    }
                });
        };

        function renderResult(data, resultElement) {
            let statusHTML = '';
            let themeColor = '';
            let themeBg = '';
            let themeBorder = '';

            if (data.relation === "FRIENDLY") {
                statusHTML = 'ඉතා සුභයි ⭐<br><span style="font-size: 1rem; font-weight:normal;">නාම යෝනි මිතුරු වේ.</span>';
                themeColor = 'var(--success-color, #28a745)'; // Fallback color added
                themeBg = 'var(--success-bg, #d4edda)';
                themeBorder = 'var(--success-color, #28a745)';
            } else if (data.relation === "ENEMY") {
                statusHTML = 'අසුභයි ⭕<br><span style="font-size: 1rem; font-weight:normal;">නාම යෝනි සතුරු වේ.</span>';
                themeColor = 'var(--danger-color, #dc3545)';
                themeBg = 'var(--danger-bg, #f8d7da)';
                themeBorder = 'var(--danger-color, #dc3545)';
            } else {
                statusHTML = 'සුභයි ✅';
                themeColor = 'var(--success-color, #28a745)';
                themeBg = 'var(--success-bg, #d4edda)';
                themeBorder = 'var(--success-color, #28a745)';
            }

            resultElement.innerHTML = `
                <div class="result-header" style="color: ${themeColor}">
                    ${statusHTML}
                </div>
                
                <div class="result-section">
                    <div class="result-title">මව්පිය/ සහෝදරයන්ගේ නාම යෝනිය - ${data.yoniName1.split(' ')[0]} ${data.yoniName1.split(' ')[1] || ''}</div>
                    <div class="calc-breakdown">${data.data1.list.join(', ')}</div>
                    <div class="total-value">${data.data1.total}</div>
                </div>

                <div class="result-section">
                    <div class="result-title">ජන්මයාගේ නාම යෝනිය - ${data.yoniName2.split(' ')[0]} ${data.yoniName2.split(' ')[1] || ''}</div>
                    <div class="calc-breakdown">${data.data2.list.join(', ')}</div>
                    <div class="total-value">${data.data2.total}</div>
                </div>
            `;
            
            resultElement.style.backgroundColor = themeBg;
            resultElement.style.borderColor = themeBorder;
            resultElement.style.display = 'block';
        }

        // --- Unicode Converter Script (Kept on Client for Speed) ---
        // Note: Logic kept here to ensure no typing lag for the user
        const singlishInput = document.getElementById('singlish-input');
        const sinhalaOutput = document.getElementById('sinhala-output');
        const copyBtn = document.getElementById('copy-btn');
        const clearBtn = document.getElementById('clear-btn');
        
        function buildFullMap() {
            const baseConsonants = { 'k': 'ක', 'kh': 'ඛ', 'g': 'ග', 'gh': 'ඝ', 'ch': 'ච', 'chh': 'ඡ', 'j': 'ජ', 'th': 'ත', 'thh': 'ථ', 'd': 'ඩ', 'dh': 'ද', 'q': 'ද', 'dhh': 'ධ', 'n': 'න', 'N': 'ණ', 'p': 'ප', 'ph': 'ඵ', 'b': 'බ', 'bh': 'භ', 'B': 'ඹ', 'm': 'ම', 'y': 'ය', 'r': 'ර', 'l': 'ල', 'L': 'ළ', 'v': 'ව', 'w': 'ව', 's': 'ස', 'sh': 'ශ', 'Sh': 'ෂ', 'S': 'ෂ', 'h': 'හ', 'f': 'ෆ', 't': 'ට', 'c': 'ස', 'D': 'ඪ', 'T': 'ඨ', 'C': 'ස', 'F': 'ෆ', 'G': 'ඝ', 'H': 'හ', 'J': 'ජ', 'K': 'ඛ', 'M': 'ම', 'P': 'ඵ', 'Q': 'ධ', 'V': 'ව', 'W': 'ව', 'Y': 'ය', 'zga': 'ඟ', 'zja': 'ඦ', 'zda': 'ඬ', 'zdha': 'ඳ', 'zqa': 'ඳ', 'zk': 'ඤ', 'zh': 'ඥ', 'X': 'ඞ' };
            const pillaChars = { 'a': '', 'aa': 'ා', 'A': 'ැ', 'Aa': 'ෑ', 'AA': 'ෑ', 'i': 'ි', 'ii': 'ී', 'u': 'ු', 'uu': 'ූ', 'R': 'ෘ', 'Ru': 'ෲ', 'e': 'ෙ', 'ee': 'ේ', 'ai': 'ෛ', 'o': 'ො', 'oo': 'ෝ', 'au': 'ෞ', 'ou': 'ෞ', 'H': 'ඃ' };
            const baseVowels = { 'a': 'අ', 'aa': 'ආ', 'A': 'ඇ', 'Aa': 'ඈ', 'AA': 'ඈ', 'i': 'ඉ', 'ii': 'ඊ', 'u': 'උ', 'U': 'උ', 'uu': 'ඌ', 'R': 'ඍ', 'Ru': 'ඎ', 'e': 'එ', 'E': 'එ', 'ee': 'ඒ', 'ai': 'ඓ', 'I': 'ඓ', 'o': 'ඔ', 'O': 'ඔ', 'oo': 'ඕ', 'au': 'ඖ', 'ou': 'ඖ' };
            let consonantBlocks = { ...baseConsonants };
            const doubles = { 'tt': 'ට්ට', 'dd': 'ඩ්ඩ', 'nn': 'න්න', 'mm': 'ම්ම', 'll': 'ල්ල', 'pp': 'ප්ප' };
            Object.assign(consonantBlocks, doubles);
            const yansaya = '්‍ය';
            const rakāransaya = '්‍ර';
            for (const key in baseConsonants) {
                if (key !== 'y') consonantBlocks[key + 'y'] = baseConsonants[key] + yansaya;
                if (key !== 'r') consonantBlocks[key + 'r'] = baseConsonants[key] + rakāransaya;
            }
            let fullMap = { ...baseVowels, 'Lu': 'ළු', '.': '෴' };
            for (const blockKey in consonantBlocks) {
                const blockValue = consonantBlocks[blockKey];
                fullMap[blockKey] = blockValue + '්';
                for (const pillaKey in pillaChars) {
                    const pillaValue = pillaChars[pillaKey];
                    if (pillaKey === 'a') {
                        fullMap[blockKey + 'a'] = blockValue;
                    } else {
                        fullMap[blockKey + pillaKey] = blockValue + pillaValue;
                    }
                }
            }
            fullMap['x'] = 'ං';
            fullMap['kazn'] = 'කං';
            fullMap['z'] = '';
            return fullMap;
        }

        const conversionMap = buildFullMap();
        const sortedKeys = Object.keys(conversionMap).sort((a, b) => b.length - a.length);

        function convertSinglishToSinhala(text) {
            const words = text.split(' ');
            return words.map(word => {
                if (word.length === 0) return '';
                let converted = '';
                let i = 0;
                while (i < word.length) {
                    let matchFound = false;
                    for (const key of sortedKeys) {
                        if (word.substring(i, i + key.length) === key) {
                            converted += conversionMap[key];
                            i += key.length;
                            matchFound = true;
                            break;
                        }
                    }
                    if (!matchFound) {
                        converted += word[i];
                        i++;
                    }
                }
                return converted;
            }).join(' ');
        }

        function performConversion() {
            if(!singlishInput) return;
            const inputText = singlishInput.value;
            const outputText = convertSinglishToSinhala(inputText);
            sinhalaOutput.textContent = outputText || "සිංහල අකුරෙන් මෙතැන පෙන්වනු ලැබේ";
        }
        
        function clearText() {
            singlishInput.value = '';
            performConversion(); 
        }
        
        function showCopySuccessFeedback() {
            const originalHTML = copyBtn.innerHTML;
            copyBtn.innerHTML = `<i class="fas fa-check" style="margin-right: 5px;"></i>Copied`;
            copyBtn.disabled = true;
            setTimeout(() => {
                copyBtn.innerHTML = originalHTML;
                copyBtn.disabled = false;
            }, 2000);
        }

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.top = '-9999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                if (document.execCommand('copy')) {
                    showCopySuccessFeedback();
                } else {
                        showConverterGuide('පිටපත් කිරීමට නොහැකි විය.');
                }
            } catch (err) {
                showConverterGuide('පිටපත් කිරීමට නොහැකි විය.');
            }
            document.body.removeChild(textArea);
        }

        function copyText() {
            const textToCopy = sinhalaOutput.textContent;
            if (!textToCopy || textToCopy === 'සිංහල අකුරෙන් මෙතැන පෙන්වනු ලැබේ') {
                showConverterGuide('පිටපත් කිරීමට අකුරු නොමැත.');
                return;
            }
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(textToCopy).then(showCopySuccessFeedback).catch(err => {
                    fallbackCopyTextToClipboard(textToCopy);
                });
            } else {
                fallbackCopyTextToClipboard(textToCopy);
            }
        }
        
        if(clearBtn) clearBtn.addEventListener('click', clearText);
        if(copyBtn) copyBtn.addEventListener('click', copyText);
        if(singlishInput) {
            singlishInput.addEventListener('input', performConversion);
            performConversion();
        }
    });
    /**
 * Advanced Client-Side Protection Script
 * Prevent Right-Click, DevTools hotkeys, and Selection
 */
(function() {
    "use strict";

    // 1. Disable Right-Click (Context Menu)
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        // Optional: Alert the user
        // alert("Content is protected."); 
    }, false);

    // 2. Disable Keyboard Shortcuts (F12, Ctrl+Shift+I, Ctrl+U, Ctrl+S, Ctrl+P)
    document.addEventListener('keydown', function(e) {
        // Check for Ctrl (Windows) or Meta (Mac)
        if (e.ctrlKey || e.metaKey) {
            // Block Ctrl+S (Save), Ctrl+U (View Source), Ctrl+P (Print)
            if (e.key === 's' || e.key === 'u' || e.key === 'p') {
                e.preventDefault();
                return false;
            }
            // Block Ctrl+Shift+I (DevTools), Ctrl+Shift+J (Console), Ctrl+Shift+C (Inspect)
            if (e.shiftKey) {
                if (e.key === 'i' || e.key === 'j' || e.key === 'c') {
                    e.preventDefault();
                    return false;
                }
            }
        }
        
        // Block F12 (DevTools)
        if (e.key === 'F12') {
            e.preventDefault();
            return false;
        }
    });

    // 3. Disable Dragging (Images/Text)
    document.addEventListener('dragstart', function(e) {
        e.preventDefault();
    });

    // 4. Disable Text Selection (CSS backup usually required)
    document.addEventListener('selectstart', function(e) {
        e.preventDefault();
    });

})();
</script>
</body>
</html>









